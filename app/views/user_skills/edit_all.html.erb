<%= render "users/shared/profile" %>

<%= render partial: "shared/site_tabs", locals: {active: "skills", user_path: user_path(@user) } %>
<%= form_tag update_all_user_skill_path, method: :patch do %>
	<h4>Edit or Delete Skills</h4>
	<b>Here you can edit your user skills or delete them if necessary.</b><br />
	<div class="padding-10">
		<%= submit_tag "Update Changes", class: "btn btn-primary" %>
	</div>
	<div class="tab-content">
	<% survey_index = 0 %>
	<% if @user_skills.blank? %>
		<% survey_index = 1 %>
		<div class ="row survey-box-row">
			<div class="col-md-1"></div>
			<% Survey.all.each do |s|%>
				<div class="col-md-2" style="min-height: 150px">
					<h5><u><b><%= s.title %></b></u></h5>
					<p>No skills yet</p>
				</div>
				<div class="col-md-1"></div>
				<% if survey_index % 3 == 0 && survey_index < 12 %>
					</div>
					<div class ="row survey-box-row"> 
						<div class="col-md-1"></div>
				<% end %>
				<% survey_index += 1 %>
			<% end %>
		</div>
	<% else %>
		<% @user_skills.each do |user_skill| %>
			<% while survey_index < user_skill.survey_id do %>
				<!-- No Skills -->
				<% if survey_index != 0 && @user_skills.where(survey_id: survey_index).blank? %> 
					</ul>
					<p>No skills yet</p>
					</div>
					<div class="col-md-1"></div>
				<!-- Close skill box -->
				<% elsif survey_index != 0 && !@user_skills.where(survey_id: survey_index).blank? %>
					</ul>
					</div>
					<div class="col-md-1"></div>
				<% end %>

				<% survey_index += 1 %>

				<!-- Start Case -->
				<% if survey_index == 1 %>
					<div class ="row survey-box-row">
						<div class="col-md-1"></div>
				<!-- New Row Case -->
				<% elsif survey_index % 3 == 1 %>
					</div>
					<div class ="row survey-box-row">
						<div class="col-md-1"></div>
				<% end %>

				<div class="col-md-2" style="min-height: 150px">
					<h5><u><b><%= SURVEYS[survey_index] %></b></u></h5>
					<ul>
			<% end %>
			<%= fields_for 'user_skills[]', user_skill do |us| %>
				<li class="skill-padding">
        			<%= us.text_field :name, value: user_skill.skill.name, class: "form-control-skill string" %><%= link_to '', delete_user_skill_path(user_skill.id), data: {confirm: "Are you sure you want to delete this skill?"}, method: "delete", class: "glyphicon glyphicon-remove a-red" %>
        			<%= us.hidden_field :survey_id, value: survey_index %>
        		</li>
        	<% end %>
        <% end %>
        <!-- Close open UL, guaranteed to have one, and Col-md-2 from survey title -->
        </ul>
        </div>
        <div class="col-md-1"></div>
        <!-- All Surveys after the form are empty -->
        <% while survey_index < SURVEYS.length do %>
        	<% survey_index += 1 %>
        	<% if survey_index % 3 == 1 %>
				</div>
				<div class ="row survey-box-row">
					<div class="col-md-1"></div>
			<% end %>
			<div class="col-md-2" style="min-height: 150px">
				<h5><u><b><%= SURVEYS[survey_index] %></b></u></h5>
				<p>No skills yet</p>
			</div>
			<div class="col-md-1"></div>
        <% end %>
        <!-- Close final row -->
        </div>
    <% end %>
<% end %>
</div>